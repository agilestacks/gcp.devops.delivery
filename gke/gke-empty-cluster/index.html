<!doctype html><html lang=en-us dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="GKE Sandbox #  Deploy with CloudShell  Description #  Just Google Kubernetes Engine cluster
List of the components used in this sandbox:
 GKE Cluster  Setup #  First you need initialize the sandbox configuration. To do this please run the initialization command:
hub stack init The command will prompt you to enter the GCP project ID and will create initial configuration files and download required components."><meta name=theme-color content="#FFFFFF"><meta name=color-scheme content="light dark"><meta property="og:title" content="Empty GKE"><meta property="og:description" content="GKE Sandbox #  Deploy with CloudShell  Description #  Just Google Kubernetes Engine cluster
List of the components used in this sandbox:
 GKE Cluster  Setup #  First you need initialize the sandbox configuration. To do this please run the initialization command:
hub stack init The command will prompt you to enter the GCP project ID and will create initial configuration files and download required components."><meta property="og:type" content="article"><meta property="og:url" content="http://google.devops.delivery/gke/gke-empty-cluster/"><meta property="article:section" content="gke"><title>Empty GKE | GCP Support Sandboxes</title><link rel=manifest href=/manifest.json><link rel=icon href=/favicon.png type=image/x-icon><link rel=stylesheet href=/book.min.82c5dbd23447cee0b4c2aa3ed08ce0961faa40e1fa370eee4f8c9f02e0d46b5f.css integrity="sha256-gsXb0jRHzuC0wqo+0Izglh+qQOH6Nw7uT4yfAuDUa18=" crossorigin=anonymous><script defer src=/flexsearch.min.js></script>
<script defer src=/en.search.min.40b1e3556963ee12dd2cde84930f72e5f6b50b3f29c5bce0455bf246d6a7538f.js integrity="sha256-QLHjVWlj7hLdLN6Ekw9y5fa1Cz8pxbzgRVvyRtanU48=" crossorigin=anonymous></script></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/><span>GCP Support Sandboxes</span></a></h2><div class=book-search><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><ul><li><span>Cloud Composer</span><ul><li><a href=/composer/composer-demo-app/>With Demo App</a></li><li><a href=/composer/composer/>Just Composer</a></li></ul></li><li><span>Cloud SQL</span><ul><li><a href=/cloud-sql/cloud-sql-perftest/>With Load Test</a></li></ul></li><li><span>GKE</span><ul><li><a href=/gke/gke-empty-cluster/ class=active>Empty GKE</a></li><li><a href=/gke/gke-with-demo-app/>With Demo App</a></li><li><a href=/gke/gke-anthos-with-demo-app/>ASM with Demo App</a></li></ul></li><li><span>VM</span><ul><li><a href=/vm/vm-php-web-server/>Web Server + PHP + Cloud SQL</a></li></ul></li></ul><ul><li><a href=https://github.com/agilestacks/google-stacks target=_blank rel=noopener>Github</a></li></ul></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu></label>
<strong>Empty GKE</strong>
<label for=toc-control></label></div></header><article class=markdown><h1 id=gke-sandbox>GKE Sandbox
<a class=anchor href=#gke-sandbox>#</a></h1><a href="https://ssh.cloud.google.com/cloudshell/editor?cloudshell_git_repo=https://github.com/agilestacks/google-stacks&&cloudshell_git_branch=main&cloudshell_image=gcr.io/superhub/cloud-shell&cloudshell_tutorial=README.md&cloudshell_open_in_editor=hub.yaml&cloudshell_workspace=gke-empty-cluster" target=_blank rel=noopener class=book-btn>Deploy with CloudShell</a><h2 id=description>Description
<a class=anchor href=#description>#</a></h2><p>Just Google Kubernetes Engine cluster</p><p>List of the components used in this sandbox:</p><ul><li><a href=https://github.com/agilestacks/google-components/tree/main/gke-gcloud><code>GKE Cluster</code></a></li></ul><h2 id=setup>Setup
<a class=anchor href=#setup>#</a></h2><p>First you need initialize the sandbox configuration.
To do this please run the initialization command:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>hub stack init
</span></span></code></pre></div><p>The command will prompt you to enter the <code>GCP project ID</code> and
will create initial configuration files and download required components.</p><p>By default command enable auto configure of sandbox during <code>deploy</code> or <code>undeploy</code>.</p><h3 id=advance-case>Advance case
<a class=anchor href=#advance-case>#</a></h3><p>For some advanced cases you need to configure sandbox manually.
To do this just pass <code>--disable-auto-configure</code> flag:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>hub stack init --disable-auto-configure
</span></span></code></pre></div><p>And after that to configure sandbox manually run command:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>hub stack configure
</span></span></code></pre></div><p>The <a href=https://superhub.io>Hub CLI</a> produces a state file after provisioning of sandbox,
same as its components, and it must be uploaded to the cloud.
For simplicity, we pre-create <code>Cloud DNS Zone</code> and <code>GCS bucket</code>
in your GCP project with pre-generated names.
This is done during <code>configure</code> command.</p><h2 id=deployundeploy>Deploy/Undeploy
<a class=anchor href=#deployundeploy>#</a></h2><p>Once you are done with the configuration, use the following command to deploy the sandbox:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>hub stack deploy
</span></span></code></pre></div><p>To deploy a specific component on the sandbox:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>hub stack deploy -c &lt;name-of-the-component&gt;
</span></span></code></pre></div><p>To undeploy a specific component on the sandbox:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>hub stack undeploy -c &lt;name-of-the-component&gt;
</span></span></code></pre></div><p>If any of the sandbox components would require additional configuration parameters,
users will be asked to provide them.</p><p>To delete the sandbox run this command:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>hub stack undeploy
</span></span></code></pre></div><h3 id=parameters>Parameters
<a class=anchor href=#parameters>#</a></h3><p>Each <code>component</code> has a set of parameters (key-value pairs) such as
GKE cluster name or number of nodes in a node pool, etc.</p><p>Please explore <code>parameters</code> section of the <code>hub.yaml</code> to see what parameters are available.
Any default value can be overridden.
To get more information on how components are implemented refer to their README files.</p><h2 id=recover>Recover
<a class=anchor href=#recover>#</a></h2><p>Google Cloud Shell environments are ephemeral, which means any files stored locally
on the Cloud Shell machine will be lost when the machine restarts.
Luckily, we store sandbox state files in the Cloud, which means,
if we lose a local state, we can always recover it from the Cloud.</p><p>In order to recover your sandbox first you need to find ID of sandbox
in the list of sandboxes in your GCP project.</p><p>To do this run next command:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>hub state ls
</span></span></code></pre></div><p>Next step will be initializations of your target sandbox:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>hub stack init <span style=color:#f92672>[</span>id<span style=color:#f92672>]</span>
</span></span></code></pre></div><p><a href=https://superhub.io>Hub CLI</a> will find location of state file, download it and prepare configuration files.</p></article><footer class=book-footer><div class="flex flex-wrap justify-between"></div><script>(function(){function e(n){const e=window.getSelection(),t=document.createRange();t.selectNodeContents(n),e.removeAllRanges(),e.addRange(t)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div></main></body></html>